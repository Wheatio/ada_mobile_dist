import{a as K}from"./QSelect.d90f3d55.js";import{d as Y,h as J,Q as X}from"./QInput.c5637279.js";import{r as Q,f as o,j as d,at as G,Y as W,k as B,as as Z,q as O,az as y,v as $,g as P,e as ee,m as te,H as V,J as se,_ as ae,o as C,$ as I,w as k,a as A,d as b,c as le,a4 as re,a5 as oe,a0 as ne,Q as ue,a1 as ie,a2 as ce}from"./index.3e2de913.js";import{a as de,u as fe}from"./use-dark.c0da1af0.js";import{k as me,j as he,Q as N}from"./QItem.316c8aa3.js";import{a as L,Q as ge}from"./awardAPI.de8d18fc.js";import"./format.feb17ea1.js";import"./focus-manager.8e1b27e8.js";function pe(t,s){const e=Q(null),g=o(()=>t.disable===!0?null:d("span",{ref:e,class:"no-outline",tabindex:-1}));function l(n){const r=s.value;n!==void 0&&n.type.indexOf("key")===0?r!==null&&document.activeElement!==r&&r.contains(document.activeElement)===!0&&r.focus():e.value!==null&&(n===void 0||r!==null&&r.contains(n.target)===!0)&&e.value.focus()}return{refocusTargetEl:g,refocusTarget:l}}var ve={xs:30,sm:35,md:40,lg:50,xl:60};const be={...fe,...Z,...Y,modelValue:{required:!0,default:null},val:{},trueValue:{default:!0},falseValue:{default:!1},indeterminateValue:{default:null},checkedIcon:String,uncheckedIcon:String,indeterminateIcon:String,toggleOrder:{type:String,validator:t=>t==="tf"||t==="ft"},toggleIndeterminate:Boolean,label:String,leftLabel:Boolean,color:String,keepColor:Boolean,dense:Boolean,disable:Boolean,tabindex:[String,Number]},ye=["update:modelValue"];function ke(t,s){const{props:e,slots:g,emit:l,proxy:n}=O(),{$q:r}=n,f=de(e,r),p=Q(null),{refocusTargetEl:x,refocusTarget:S}=pe(e,p),u=G(e,ve),i=o(()=>e.val!==void 0&&Array.isArray(e.modelValue)),h=o(()=>{const a=y(e.val);return i.value===!0?e.modelValue.findIndex(v=>y(v)===a):-1}),c=o(()=>i.value===!0?h.value>-1:y(e.modelValue)===y(e.trueValue)),m=o(()=>i.value===!0?h.value===-1:y(e.modelValue)===y(e.falseValue)),_=o(()=>c.value===!1&&m.value===!1),T=o(()=>e.disable===!0?-1:e.tabindex||0),j=o(()=>`q-${t} cursor-pointer no-outline row inline no-wrap items-center`+(e.disable===!0?" disabled":"")+(f.value===!0?` q-${t}--dark`:"")+(e.dense===!0?` q-${t}--dense`:"")+(e.leftLabel===!0?" reverse":"")),D=o(()=>{const a=c.value===!0?"truthy":m.value===!0?"falsy":"indet",v=e.color!==void 0&&(e.keepColor===!0||(t==="toggle"?c.value===!0:m.value!==!0))?` text-${e.color}`:"";return`q-${t}__inner relative-position non-selectable q-${t}__inner--${a}${v}`}),U=o(()=>{const a={type:"checkbox"};return e.name!==void 0&&Object.assign(a,{".checked":c.value,"^checked":c.value===!0?"checked":void 0,name:e.name,value:i.value===!0?e.val:e.trueValue}),a}),F=J(U),z=o(()=>{const a={tabindex:T.value,role:t==="toggle"?"switch":"checkbox","aria-label":e.label,"aria-checked":_.value===!0?"mixed":c.value===!0?"true":"false"};return e.disable===!0&&(a["aria-disabled"]="true"),a});function w(a){a!==void 0&&($(a),S(a)),e.disable!==!0&&l("update:modelValue",E(),a)}function E(){if(i.value===!0){if(c.value===!0){const a=e.modelValue.slice();return a.splice(h.value,1),a}return e.modelValue.concat([e.val])}if(c.value===!0){if(e.toggleOrder!=="ft"||e.toggleIndeterminate===!1)return e.falseValue}else if(m.value===!0){if(e.toggleOrder==="ft"||e.toggleIndeterminate===!1)return e.trueValue}else return e.toggleOrder!=="ft"?e.trueValue:e.falseValue;return e.indeterminateValue}function M(a){(a.keyCode===13||a.keyCode===32)&&$(a)}function R(a){(a.keyCode===13||a.keyCode===32)&&w(a)}const H=s(c,_);return Object.assign(n,{toggle:w}),()=>{const a=H();e.disable!==!0&&F(a,"unshift",` q-${t}__native absolute q-ma-none q-pa-none`);const v=[d("div",{class:D.value,style:u.value,"aria-hidden":"true"},a)];x.value!==null&&v.push(x.value);const q=e.label!==void 0?W(g.default,[e.label]):B(g.default);return q!==void 0&&v.push(d("div",{class:`q-${t}__label q-anchor--skip`},q)),d("div",{ref:p,class:j.value,...z.value,onClick:w,onKeydown:M,onKeyup:R},v)}}const xe=d("div",{key:"svg",class:"q-checkbox__bg absolute"},[d("svg",{class:"q-checkbox__svg fit absolute-full",viewBox:"0 0 24 24"},[d("path",{class:"q-checkbox__truthy",fill:"none",d:"M1.73,12.91 8.1,19.28 22.79,4.59"}),d("path",{class:"q-checkbox__indet",d:"M4,14H20V10H4"})])]);var Ce=P({name:"QCheckbox",props:be,emits:ye,setup(t){function s(e,g){const l=o(()=>(e.value===!0?t.checkedIcon:g.value===!0?t.indeterminateIcon:t.uncheckedIcon)||null);return()=>l.value!==null?[d("div",{key:"icon",class:"q-checkbox__icon-container absolute-full flex flex-center no-wrap"},[d(ee,{class:"q-checkbox__icon",name:l.value})])]:[xe]}return ke("checkbox",s)}});const Se={position:{type:String,default:"bottom-right",validator:t=>["top-right","top-left","bottom-right","bottom-left","top","right","bottom","left"].includes(t)},offset:{type:Array,validator:t=>t.length===2},expand:Boolean};function we(){const{props:t,proxy:{$q:s}}=O(),e=te(se,V);if(e===V)return console.error("QPageSticky needs to be child of QLayout"),V;const g=o(()=>{const u=t.position;return{top:u.indexOf("top")>-1,right:u.indexOf("right")>-1,bottom:u.indexOf("bottom")>-1,left:u.indexOf("left")>-1,vertical:u==="top"||u==="bottom",horizontal:u==="left"||u==="right"}}),l=o(()=>e.header.offset),n=o(()=>e.right.offset),r=o(()=>e.footer.offset),f=o(()=>e.left.offset),p=o(()=>{let u=0,i=0;const h=g.value,c=s.lang.rtl===!0?-1:1;h.top===!0&&l.value!==0?i=`${l.value}px`:h.bottom===!0&&r.value!==0&&(i=`${-r.value}px`),h.left===!0&&f.value!==0?u=`${c*f.value}px`:h.right===!0&&n.value!==0&&(u=`${-c*n.value}px`);const m={transform:`translate(${u}, ${i})`};return t.offset&&(m.margin=`${t.offset[1]}px ${t.offset[0]}px`),h.vertical===!0?(f.value!==0&&(m[s.lang.rtl===!0?"right":"left"]=`${f.value}px`),n.value!==0&&(m[s.lang.rtl===!0?"left":"right"]=`${n.value}px`)):h.horizontal===!0&&(l.value!==0&&(m.top=`${l.value}px`),r.value!==0&&(m.bottom=`${r.value}px`)),m}),x=o(()=>`q-page-sticky row flex-center fixed-${t.position} q-page-sticky--${t.expand===!0?"expand":"shrink"}`);function S(u){const i=B(u.default);return d("div",{class:x.value,style:p.value},t.expand===!0?i:[d("div",i)])}return{$layout:e,getStickyContent:S}}var Ve=P({name:"QPageSticky",props:Se,setup(t,{slots:s}){const{getStickyContent:e}=we();return()=>e(s)}});const Ie={props:["moduleType","category"],data(){return{fullClassLists:[],loadingClassLists:!0,classNameOptions:[],selectedClass:null,selectedStudentsArray:[],description:null}},methods:{award(){this.selectedStudentsArray.forEach((t,s)=>{t&&(console.log("awarding thing to",this.selectedStudentList[0].students[s]),this.awardCommendation(this.selectedStudentList[0].students[s].misId))}),this.$router.push("/award")},getAllStudents(){this.loadingClassLists=!0,L.getStudentsInAllClasses(this.processStudentsInClasses)},processStudentsInClasses(t){this.fullClassLists=t,console.log("class lists: ",this.fullClassLists);const s=t.map(e=>({label:e.code,value:e.misId}));this.classNameOptions=s,this.selectedClass=this.classNameOptions[0].value,this.setUpCheckBoxArray()},setUpCheckBoxArray(){this.selectedStudentsArray=[];const t=[];for(let s=0;s<this.selectedStudentList[0].students.length;s++)t.push(!1);this.selectedStudentsArray=t,this.loadingClassLists=!1},awardCommendation(t){const s={date:new Date,categoryId:Number(this.category),moduleTypeId:Number(this.moduleType),teacherId:this.userDetails.isamsId,description:this.description,subjectId:this.currentSubject};console.log("awarding commendation: to ",t,s),L.postAward(this.awardSuccess,this.awardFail,t,s)},awardSuccess(t){this.$q.notify({position:"center",message:"successfully awarded",color:"green"}),this.selectedStudent=null,this.photo=null,this.description=null},awardFail(){this.$q.notify({position:"center",color:"red",message:"awarding failed, check your connection to the internet"})}},watch:{selectedClass(){this.setUpCheckBoxArray()}},computed:{userClasses(){return this.$store.getters["user/getUserClasses"]},selectedStudentList(){return this.fullClassLists.filter(s=>s.misId===this.selectedClass)},disableDueToValidation(){return!(this.selectedStudentsArray.includes(!0)&&this.description)},userSubjects(){return this.$store.getters["user/getUserClasses"]},userId(){return this.$store.getters["user/userId"]},userDetails(){return this.$store.getters["user/getUserDetails"]},awardCategories(){return this.$store.getters["awards/getAwardCategories"]},currentModule(){return this.awardCategories?this.awardCategories.find(s=>Number(s.id)===Number(this.moduleType)):[]},currentCategory(){return this.currentModule?this.currentModule.categories.find(s=>Number(s.id)===Number(this.category)):[]},currentSubject(){return Number(this.category)===33||Number(this.category)===38?63:Number(this.category)===35||Number(this.category)===39?62:this.userClasses[0].id}},mounted(){this.getAllStudents()}},_e={class:"flex-auto q-my-lg",style:{height:"65vh","overflow-y":"auto"}};function qe(t,s,e,g,l,n){return C(),I(ge,null,{default:k(()=>[A("div",null,[b(K,{class:"q-ma-sm",options:l.classNameOptions,outlined:"",standout:"","map-options":"","emit-value":"",modelValue:l.selectedClass,"onUpdate:modelValue":s[0]||(s[0]=r=>l.selectedClass=r)},null,8,["options","modelValue"]),b(X,{class:"q-mx-xl",outlined:"",label:"description (required)",modelValue:l.description,"onUpdate:modelValue":s[1]||(s[1]=r=>l.description=r),rules:[r=>!!r||"description is required"]},null,8,["modelValue","rules"])]),A("div",_e,[l.loadingClassLists?ne("",!0):(C(),I(me,{key:0,dense:""},{default:k(()=>[(C(!0),le(oe,null,re(n.selectedStudentList[0].students,(r,f)=>(C(),I(he,{key:r.id},{default:k(()=>[b(N,{side:""},{default:k(()=>[b(Ce,{modelValue:l.selectedStudentsArray[f],"onUpdate:modelValue":p=>l.selectedStudentsArray[f]=p},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),b(N,{clickable:"",onClick:p=>l.selectedStudentsArray[f]=!l.selectedStudentsArray[f]},{default:k(()=>[ie(ce(r.fullName),1)]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1}))]),b(Ve,{position:"bottom-right",class:"q-pa-md"},{default:k(()=>[b(ue,{rounded:"",class:"q-pa-md",style:{width:"40vw"},color:"primary",label:"Award",onClick:n.award,disable:n.disableDueToValidation},null,8,["onClick","disable"])]),_:1})]),_:1})}var Te=ae(Ie,[["render",qe]]);export{Te as default};
